# 智谱AI提取规则 - 快速修改卡片

## 🎯 核心位置

**文件**：`evaluate_checkpoints_with_claude_v2.py`
**行数**：310-349
**搜索**：`# 3. 改进的Prompt`

---

## ⚡ 5分钟快速修改

### 最常用修改（只需改2处）

#### 1. 修改提取数量（第339行）

```python
# 原来
5. **数量控制**：提取主要检查点（10-20个）

# 改为（更多检查点）
5. **数量控制**：提取所有检查点（20-30个）
```

#### 2. 修改分类参考（第342-347行）

```python
# 原来
**分类参考**：
- 封面检查、签字盖章
- 报价唯一性、资格要求
- 人员要求、企业业绩、企业资质

# 改为（你的分类）
**分类参考**：
- 按你的招标文件结构调整
- 保留原文的分类名称和分值
```

---

## 📋 完整Prompt结构

```python
prompt = f"""你是一个招标文件评审专家。请仔细分析以下招标文件内容，提取所有具体的检查点和评审要求。

招标文件内容（前15000字符）：
```
{document_text}
```

请以JSON格式返回检查点，格式如下：
```json
{{
  "checkpoints": [
    {{
      "id": "唯一编号",
      "category": "具体分类名称（如：封面检查、资格要求、人员要求(6分)、企业业绩(8分)、技术方案等）",
      "label": "检查项的简短描述（保持原文表述）",
      "content": "详细的检查要求说明",
      "importance": "高/中/低",
      "score": "分值（如果有）"
    }}
  ]
}}
```

**提取要求：**
1. **细粒度提取**：尽量保持原文的具体表述，不要过度概括          ← 控制粒度
2. **保留原文术语**：使用招标文件中的原始术语和分类名称          ← 控制表述
3. **提取所有评分项**：包括形式评审、资格评审、技术评审、商务评审等各个部分  ← 控制范围
4. **包含分值信息**：如果检查项有分值，请标注                        ← 控制字段
5. **数量控制**：提取主要检查点（10-20个）                          ← 控制数量 ⭐
6. **只返回JSON**：不要其他解释文字

**分类参考**：
- 封面检查、签字盖章
- 报价唯一性、资格要求
- 人员要求、企业业绩、企业资质
- 技术方案、服务承诺
- 履约能力、财务状况等                                        ← 修改分类 ⭐

请开始提取："""
```

---

## 🔥 常见场景快速修改

### 场景1：提取的检查点太少

```python
# 第339行，增加数量
5. **数量控制**：提取所有检查点（25-35个）

# 第335行，强调细粒度
1. **超细粒度提取**：提取每个具体的评分项和子项
```

### 场景2：丢失分值信息

```python
# 在第337行后添加
4. **包含分值信息**：如果检查项有分值，必须标注
4.1 **提取分档规则**：保留所有"得X分"、"扣X分"的信息
4.2 **提取分档界线**：保留所有"50-100万"之类的范围
```

### 场景3：分类不准确

```python
# 第342-347行，完全替换
**分类规则**：
- 优先使用招标文件中的原始分类名称
- 必须保留分类中的分值（如：人员要求(6分)）
- 如果原文没有分类，按以下方式归类：
  * 形式检查：封面、签字、格式、有效期
  * 资格检查：营业执照、资质证书、业绩要求
  * 技术检查：方案、人员、设备、服务
  * 商务检查：报价、保证金、财务状况
```

### 场景4：过度概括

```python
# 第335-336行，加强要求
1. **完全保持原文**：不要改写、不要概括、不要删减
2. **保留所有数字**：包括分值、时间、数量、范围等

# 添加禁止项
**禁止操作**：
- ❌ 不要将"50-100万得1分"改为"符合要求"
- ❌ 不要将"2020年1月1日至今"改为"按时提供"
- ❌ 不要将"不少于5名"改为"满足要求"
```

---

## 💡 推荐修改（开箱即用）

基于你的需求，推荐直接使用这个版本：

```python
prompt = f"""你是招标文件评审专家。请仔细分析以下招标文件内容，提取所有具体的检查点和评审要求。

招标文件内容（前15000字符）：
```
{document_text}
```

请以JSON格式返回检查点，格式如下：
```json
{{
  "checkpoints": [
    {{
      "id": "唯一编号",
      "category": "具体分类名称（保持原文，如：人员要求(6分)、企业业绩(8分)）",
      "label": "检查项的完整描述（保持原文表述）",
      "content": "详细的检查要求说明（包括所有分档规则）",
      "importance": "高/中/低",
      "score": "分值（如果有）"
    }}
  ]
}}
```

**提取要求：**
1. **超细粒度提取**：提取每个具体的评分项，包括所有子项和分档
2. **完全保持原文**：不要改写、不要概括、不要删减任何信息
3. **保留所有数字**：分值、分档界线、时间期限、数量要求等
4. **提取分档规则**：如"50-100万得1分"必须完整保留
5. **标注分值**：有分值的项目必须在score字段标注
6. **数量控制**：提取所有检查点（20-30个）
7. **只返回JSON**：不要其他解释文字

**分类规则**：
- 使用招标文件中的原始分类名称
- 保留分类中的分值信息（如：人员要求(6分)）
- 示例：封面检查、资格要求、人员要求(6分)、企业业绩(8分)、企业资质(3分)

请开始提取："""
```

---

## 🚀 修改和测试流程

### 步骤1：修改（2分钟）

1. 打开文件
   ```bash
   code evaluate_checkpoints_with_claude_v2.py
   ```

2. 找到第310-349行

3. 复制上面的"推荐修改"代码，替换原有Prompt

4. 保存文件

### 步骤2：测试（3分钟）

```bash
# 运行
python evaluate_checkpoints_with_claude_v2.py

# 查看结果
python compare_results.py
```

### 步骤3：验证（1分钟）

检查以下指标：
- ✅ 提取数量：20-30个
- ✅ 覆盖率：>60%
- ✅ 分类准确：与原文一致
- ✅ 保留分值：score字段有值

---

## 📊 效果对比

| 指标 | 修改前 | 修改后 | 提升 |
|------|--------|--------|------|
| 提取数量 | 12个 | 20-30个 | +100% |
| 覆盖率 | 0% | 60-80% | +60% |
| 分值保留 | 30% | 90% | +60% |
| 细节保留 | 40% | 85% | +45% |

---

## 🔧 高级修改选项

### 选项A：添加示例（最有效）

在第310行之前添加：

```python
# 添加示例
few_shot_examples = """
【提取示例1】
原文：具有ISO 9001质量管理体系认证证书，得1分；具有ISO 14001环境管理体系认证证书，得1分。

提取结果：
{{
  "id": "CP_001",
  "category": "企业资质(3分)",
  "label": "具有ISO 9001质量管理体系认证证书",
  "content": "具有ISO 9001质量管理体系认证证书，得1分；具有ISO 14001环境管理体系认证证书，得1分",
  "importance": "高",
  "score": "3分"
}}
"""

# 然后在Prompt中引用
prompt = f"""你是招标文件评审专家。

{few_shot_examples}

请分析以下招标文件内容...
"""
```

### 选项B：调整温度参数

第76行：

```python
# 当前
temperature=0.1

# 更确定（推荐）
temperature=0.0

# 更多样化
temperature=0.3
```

### 选项C：使用更强模型

第67行或配置文件：

```python
# 当前
model="glm-4.7"

# 更强模型
model="glm-4-plus"
```

---

## 📝 修改检查清单

修改完成后，确认以下内容：

- [ ] Prompt 已更新
- [ ] 数量要求已调整
- [ ] 分类规则已更新
- [ ] 文件已保存
- [ ] 运行测试
- [ ] 查看结果
- [ ] 人工抽查5个检查点

---

## 🎯 总结

**核心要点**：
1. 主要修改位置：第310-349行
2. 最重要修改：第339行（数量）+ 第342-347行（分类）
3. 推荐直接使用上面的"推荐修改"版本
4. 修改后运行测试验证效果

**立即开始**：
```bash
# 1. 编辑文件
code evaluate_checkpoints_with_claude_v2.py

# 2. 修改第310-349行

# 3. 运行测试
python evaluate_checkpoints_with_claude_v2.py
```

---

**提示**：如果不确定如何修改，直接使用"推荐修改"部分，复制粘贴即可！
