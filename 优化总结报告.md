# æå‡æ¨¡å‹æå–å‡†ç¡®æ€§ - å®Œæ•´æ–¹æ¡ˆæ€»ç»“

## ğŸ“‹ ç›®å½•
1. [é—®é¢˜è¯Šæ–­](#é—®é¢˜è¯Šæ–­)
2. [æ”¹è¿›æ–¹æ¡ˆ](#æ”¹è¿›æ–¹æ¡ˆ)
3. [å®æ–½æ­¥éª¤](#å®æ–½æ­¥éª¤)
4. [æ•ˆæœé¢„æœŸ](#æ•ˆæœé¢„æœŸ)
5. [æŒç»­ä¼˜åŒ–](#æŒç»­ä¼˜åŒ–)

---

## ğŸ” é—®é¢˜è¯Šæ–­

### å½“å‰é—®é¢˜ï¼ˆåŸºäºä½ çš„æ•°æ®ï¼‰

| é—®é¢˜ | å…·ä½“è¡¨ç° | å½±å“ |
|------|---------|-----|
| **ç²’åº¦ä¸åŒ¹é…** | ç®—æ³•æå–ç»†ç²’åº¦é¡¹ï¼ˆå¦‚"äººå‘˜è¦æ±‚(6åˆ†)"ï¼‰ï¼ŒAIæå–ç²—ç²’åº¦ï¼ˆå¦‚"èµ„æ ¼è¯„å®¡"ï¼‰ | åŒ¹é…ç‡ä½ |
| **åˆ†ç±»ä½“ç³»å·®å¼‚** | ç®—æ³•ä½¿ç”¨åŸå§‹åˆ†ç±»ï¼ŒAIä½¿ç”¨é€šç”¨åˆ†ç±» | å¯¹åº”å›°éš¾ |
| **è¿‡åº¦æ¦‚æ‹¬** | AIå°†å…·ä½“è¦æ±‚æ¦‚æ‹¬ä¸ºé€šç”¨æè¿° | ä¸¢å¤±é‡è¦ç»†èŠ‚ |
| **åŒ¹é…ç®—æ³•ç®€å•** | ä»…ç”¨"2ä¸ªä»¥ä¸Šå…±åŒè¯"åˆ¤æ–­ | è¯¯åŒ¹é…æˆ–ä¸åŒ¹é… |

### æ•°æ®å¯¹æ¯”

**ç®—æ³•æå–ï¼ˆ14ä¸ªï¼‰ï¼š**
- å°é¢æ£€æŸ¥ï¼šå…·ä½“åˆ°æ¯ä¸ªæ£€æŸ¥é¡¹
- æŠ¥ä»·å”¯ä¸€æ€§ï¼šç‹¬ç«‹æ£€æŸ¥é¡¹
- äººå‘˜è¦æ±‚(6åˆ†)ï¼šå®Œæ•´çš„è¯„åˆ†æ ‡å‡†
- ä¼ä¸šä¸šç»©(8åˆ†)ï¼šè¯¦ç»†çš„åˆ†æ¡£è§„åˆ™
- èµ„è´¨è¯ä¹¦ï¼šå…·ä½“çš„è¯ä¹¦åç§°å’Œåˆ†å€¼

**æ™ºè°±AIæå–ï¼ˆ12ä¸ªï¼‰ï¼š**
- å½¢å¼è¯„å®¡ï¼šæ¦‚æ‹¬æ€§æè¿°
- èµ„æ ¼è¯„å®¡ï¼šé€šç”¨æ€§æ£€æŸ¥
- æŠ€æœ¯è¯„å®¡ï¼šæ€»ä½“æ€§è¦æ±‚
- å•†åŠ¡è¯„å®¡ï¼šä»·æ ¼ç›¸å…³æ£€æŸ¥

**åŒ¹é…ç»“æœï¼š0å¯¹** âŒ

---

## ğŸš€ æ”¹è¿›æ–¹æ¡ˆ

### âœ… æ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ | éš¾åº¦ | æˆæœ¬ | é¢„æœŸæå‡ | å®æ–½æ—¶é—´ | æ¨èåº¦ |
|------|------|------|---------|---------|--------|
| **1. ä¼˜åŒ–Prompt** | â­ | 0 | +50-70% | 10åˆ†é’Ÿ | â­â­â­â­â­ |
| **2. Few-Shotå­¦ä¹ ** | â­â­ | 0 | +30-40% | 30åˆ†é’Ÿ | â­â­â­â­ |
| **3. å‡çº§æ¨¡å‹** | â­ | $ | +25-35% | 5åˆ†é’Ÿ | â­â­â­â­ |
| **4. æ”¹è¿›åŒ¹é…ç®—æ³•** | â­â­â­ | 0 | +20-30% | 2å°æ—¶ | â­â­â­ |
| **5. å¤šé˜¶æ®µæå–** | â­â­â­â­ | 0 | +40-60% | 4å°æ—¶ | â­â­â­ |
| **6. è¿­ä»£ä¼˜åŒ–** | â­â­â­ | 0 | +35-50% | 3å°æ—¶ | â­â­â­ |

---

## ğŸ“– å®æ–½æ­¥éª¤

### é˜¶æ®µ1ï¼šå¿«é€Ÿè§æ•ˆï¼ˆå·²å®æ–½âœ…ï¼‰

#### æ­¥éª¤1.1ï¼šè¿è¡Œä¼˜åŒ–ç‰ˆæœ¬

```bash
cd d:\interface_pytest\interface_pytest
python evaluate_checkpoints_with_claude_v2.py
```

**å·²å®Œæˆçš„ä¼˜åŒ–ï¼š**
- âœ… Promptä¼˜åŒ–ï¼ˆæ˜ç¡®è¦æ±‚ä¿æŒåŸæ–‡è¡¨è¿°ï¼‰
- âœ… æ–‡æœ¬é•¿åº¦å¢åŠ ï¼ˆ10,000 â†’ 15,000å­—ç¬¦ï¼‰
- âœ… åˆ†ç±»å‚è€ƒï¼ˆå°é¢æ£€æŸ¥ã€äººå‘˜è¦æ±‚(6åˆ†)ç­‰ï¼‰
- âœ… æ”¹è¿›åŒ¹é…ç®—æ³•ï¼ˆJaccardç›¸ä¼¼åº¦ï¼‰
- âœ… å¯è°ƒé˜ˆå€¼ï¼ˆé»˜è®¤0.3ï¼‰

#### æ­¥éª¤1.2ï¼šæŸ¥çœ‹ç»“æœ

```bash
python compare_results.py
```

**é¢„æœŸæ”¹è¿›ï¼š**
```
è¦†ç›–ç‡: 0% â†’ 50-70%
å¬å›ç‡: 0% â†’ 40-60%
åŒ¹é…å¯¹: 0å¯¹ â†’ 7-10å¯¹
```

### é˜¶æ®µ2ï¼šè¿›ä¸€æ­¥ä¼˜åŒ–ï¼ˆå¯é€‰ï¼‰

#### é€‰é¡¹Aï¼šæ·»åŠ Few-Shotç¤ºä¾‹

ç¼–è¾‘ `evaluate_checkpoints_with_claude_v2.py`ï¼Œåœ¨Promptä¸­æ·»åŠ ï¼š

```python
prompt = f"""ä½ æ˜¯æ‹›æ ‡æ–‡ä»¶è¯„å®¡ä¸“å®¶ã€‚

**æå–ç¤ºä¾‹ï¼š**

ã€ç¤ºä¾‹1ã€‘
åŸæ–‡ï¼šå…·æœ‰ISO 9001è´¨é‡ç®¡ç†ä½“ç³»è®¤è¯è¯ä¹¦ï¼Œå¾—1åˆ†ï¼›å…·æœ‰ISO 14001ç¯å¢ƒç®¡ç†ä½“ç³»è®¤è¯è¯ä¹¦ï¼Œå¾—1åˆ†ã€‚

æå–ç»“æœï¼š
{{
  "id": "CP_001",
  "category": "ä¼ä¸šèµ„è´¨(3åˆ†)",
  "label": "å…·æœ‰ISO 9001è´¨é‡ç®¡ç†ä½“ç³»è®¤è¯è¯ä¹¦",
  "content": "å…·æœ‰ISO 9001è´¨é‡ç®¡ç†ä½“ç³»è®¤è¯è¯ä¹¦ï¼Œå¾—1åˆ†ï¼›å…·æœ‰ISO 14001ç¯å¢ƒç®¡ç†ä½“ç³»è®¤è¯è¯ä¹¦ï¼Œå¾—1åˆ†",
  "importance": "é«˜",
  "score": "3åˆ†"
}}

ã€ç¤ºä¾‹2ã€‘
åŸæ–‡ï¼šåº”ç­”äººé¡»æä¾›åœ¨2020å¹´1æœˆ1æ—¥è‡³å…¬å‘Šå‘å¸ƒä¹‹æ—¥æ­¢ï¼ŒæœŸé—´å›½å†…æ‰¿æ¥ç±»ä¼¼æœºæˆ¿ç»´æŠ¤é¡¹ç›®åˆåŒä¸šç»©æ¡ˆä¾‹ï¼š50ä¸‡(å«)ä»¥ä¸‹ä¸å¾—åˆ†ï¼›50-100ä¸‡(å«)å¾—1åˆ†ï¼›100-150ä¸‡(å«)å¾—2åˆ†...

æå–ç»“æœï¼š
{{
  "id": "CP_002",
  "category": "äººå‘˜è¦æ±‚(6åˆ†)",
  "label": "åº”ç­”äººé¡»æä¾›...æœŸé—´å›½å†…æ‰¿æ¥ç±»ä¼¼...åˆåŒä¸šç»©æ¡ˆä¾‹",
  "content": "50ä¸‡(å«)ä»¥ä¸‹ä¸å¾—åˆ†ï¼›50-100ä¸‡(å«)å¾—1åˆ†ï¼›100-150ä¸‡(å«)å¾—2åˆ†ï¼›150-200ä¸‡(å«)å¾—3åˆ†...",
  "importance": "é«˜",
  "score": "6åˆ†"
}}

**ç°åœ¨è¯·åˆ†æä»¥ä¸‹æ‹›æ ‡æ–‡ä»¶ï¼š**

æ‹›æ ‡æ–‡ä»¶å†…å®¹ï¼ˆå‰15000å­—ç¬¦ï¼‰ï¼š
```
{document_text}
```

è¯·æŒ‰ç…§ä¸Šè¿°ç¤ºä¾‹çš„æ ¼å¼å’Œç²’åº¦ï¼Œæå–æ‰€æœ‰æ£€æŸ¥ç‚¹...
"""
```

**é¢„æœŸæ•ˆæœï¼š**
- æå–å‡†ç¡®æ€§ +20-30%
- åˆ†ç±»ä¸€è‡´æ€§ +25%

#### é€‰é¡¹Bï¼šä½¿ç”¨æ›´å¼ºæ¨¡å‹

ç¼–è¾‘é…ç½®æ–‡ä»¶ `test_data/evaluation/evaluation_config.yaml`ï¼š

```yaml
# ä½¿ç”¨æ›´å¼ºæ¨¡å‹
zhipuai_model: "glm-4-plus"

# æˆ–ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬
zhipuai_model: "glm-4-0520"
```

**æ¨¡å‹å¯¹æ¯”ï¼š**
| æ¨¡å‹ | ç†è§£èƒ½åŠ› | é€Ÿåº¦ | æˆæœ¬ | æ¨èåœºæ™¯ |
|------|---------|------|------|---------|
| glm-4.7 | â­â­â­ | â­â­â­â­â­ | $ | å¿«é€ŸéªŒè¯ |
| glm-4-plus | â­â­â­â­â­ | â­â­â­ | $$ | ç”Ÿäº§ç¯å¢ƒ |
| glm-4-0520 | â­â­â­â­â­ | â­â­â­â­ | $$ | æœ€æ–°æœ€ä½³ |

#### é€‰é¡¹Cï¼šè°ƒæ•´ç›¸ä¼¼åº¦é˜ˆå€¼

ç¼–è¾‘ `evaluate_checkpoints_with_claude_v2.py`ï¼š

```python
# æ ¹æ®æ•ˆæœè°ƒæ•´é˜ˆå€¼
threshold = 0.25  # é™ä½ä»¥è·å¾—æ›´å¤šåŒ¹é…
# threshold = 0.35  # æé«˜ä»¥å‡å°‘è¯¯æŠ¥
```

**é˜ˆå€¼é€‰æ‹©æŒ‡å—ï¼š**
- **0.20-0.25**ï¼šå®½æ¾ï¼Œæ›´å¤šåŒ¹é…ï¼Œå¯èƒ½æœ‰è¯¯æŠ¥
- **0.30-0.35**ï¼šå¹³è¡¡ï¼Œæ¨èé»˜è®¤å€¼
- **0.40-0.50**ï¼šä¸¥æ ¼ï¼Œæ›´å°‘åŒ¹é…ï¼Œæ›´å‡†ç¡®

---

## ğŸ“Š æ•ˆæœé¢„æœŸ

### é¢„æœŸæ”¹è¿›æ›²çº¿

```
è¦†ç›–ç‡
100% |                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     |               â”Œâ”€â”€â”€â”€â”˜
 80% |          â”Œâ”€â”€â”€â”€â”˜
     |     â”Œâ”€â”€â”€â”€â”˜
 60% |â”€â”€â”€â”€â”˜
     |
 40% |
     |
 20% |
     |
  0% â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      åŸç‰ˆ   V2    +FewShot  +æ›´å¼ºæ¨¡å‹
```

### åˆ†é˜¶æ®µæ•ˆæœ

| é˜¶æ®µ | è¦†ç›–ç‡ | å¬å›ç‡ | åŒ¹é…æ•° | è¯´æ˜ |
|------|--------|--------|--------|------|
| **åŸç‰ˆ** | 0% | 0% | 0/14 | åŸºå‡† |
| **V2ä¼˜åŒ–** | 50-70% | 40-60% | 7-10/14 | Promptæ”¹è¿› |
| **+FewShot** | 70-85% | 60-75% | 10-12/14 | ç¤ºä¾‹å­¦ä¹  |
| **+æ›´å¼ºæ¨¡å‹** | 80-90% | 70-85% | 11-13/14 | æ¨¡å‹å‡çº§ |
| **+è¿­ä»£ä¼˜åŒ–** | 90-95% | 80-90% | 13-14/14 | æŒç»­æ”¹è¿› |

---

## ğŸ”„ æŒç»­ä¼˜åŒ–

### å»ºç«‹åé¦ˆå¾ªç¯

```mermaid
graph LR
    A[è¿è¡Œè¯„ä¼°] --> B[åˆ†æç»“æœ]
    B --> C{è¦†ç›–ç‡è¾¾æ ‡?}
    C -->|å¦| D[è°ƒæ•´Prompt]
    C -->|æ˜¯| E[äººå·¥æŠ½æŸ¥]
    D --> A
    E --> F{å‡†ç¡®æ€§æ»¡æ„?}
    F -->|å¦| G[æ·»åŠ ç¤ºä¾‹]
    F -->|æ˜¯| H[å®Œæˆä¼˜åŒ–]
    G --> A
```

### ä¼˜åŒ–æ£€æŸ¥æ¸…å•

**æ¯æ¬¡è¿è¡Œåæ£€æŸ¥ï¼š**
- [ ] æå–æ•°é‡æ˜¯å¦åˆç†ï¼ˆ15-18ä¸ªï¼‰
- [ ] è¦†ç›–ç‡æ˜¯å¦è¾¾æ ‡ï¼ˆ>70%ï¼‰
- [ ] äººå·¥æŠ½æŸ¥5ä¸ªæ˜¯å¦å‡†ç¡®
- [ ] åˆ†ç±»æ˜¯å¦ä¸ç®—æ³•ä¸€è‡´
- [ ] æ˜¯å¦é—æ¼é‡è¦æ£€æŸ¥ç‚¹

**å®šæœŸä¼˜åŒ–ï¼š**
- [ ] æ¯å‘¨æ›´æ–°Few-Shotç¤ºä¾‹
- [ ] æ¯æœˆè¯„ä¼°æ–°çš„æ¨¡å‹ç‰ˆæœ¬
- [ ] æ”¶é›†åæ¡ˆä¾‹åˆ†æ
- [ ] è°ƒæ•´ç›¸ä¼¼åº¦é˜ˆå€¼

### é«˜çº§æŠ€å·§

#### æŠ€å·§1ï¼šåŠ¨æ€é˜ˆå€¼

```python
def dynamic_threshold(algo_count, ai_count):
    """æ ¹æ®æ£€æŸ¥ç‚¹æ•°é‡åŠ¨æ€è°ƒæ•´é˜ˆå€¼"""
    ratio = ai_count / algo_count if algo_count > 0 else 1

    if ratio > 1.2:  # AIæå–è¿‡å¤šï¼Œæé«˜é˜ˆå€¼
        return 0.35
    elif ratio < 0.8:  # AIæå–è¿‡å°‘ï¼Œé™ä½é˜ˆå€¼
        return 0.25
    else:  # æ•°é‡ç›¸å½“ï¼Œä½¿ç”¨æ ‡å‡†é˜ˆå€¼
        return 0.30
```

#### æŠ€å·§2ï¼šå¤šæ¨¡å‹é›†æˆ

```python
def ensemble_extraction(document_text):
    """å¤šæ¨¡å‹é›†æˆæå–"""
    # æ¨¡å‹1ï¼šæ ‡å‡†æå–
    checkpoints_1 = extract_with_model(document_text, "glm-4.7")

    # æ¨¡å‹2ï¼šç²¾ç»†æå–
    checkpoints_2 = extract_with_model(document_text, "glm-4-plus")

    # åˆå¹¶å»é‡
    merged = merge_and_deduplicate(checkpoints_1, checkpoints_2)

    return merged
```

#### æŠ€å·§3ï¼šä¸»åŠ¨å­¦ä¹ 

```python
def active_learning_check(checkpoints, human_feedback):
    """æ ¹æ®äººå·¥åé¦ˆä¼˜åŒ–Prompt"""

    # è®°å½•åæ¡ˆä¾‹
    bad_cases = [cp for cp, rating in zip(checkpoints, human_feedback) if rating < 3]

    # ç”Ÿæˆé’ˆå¯¹æ€§ç¤ºä¾‹
    examples = generate_few_shot_from_cases(bad_cases)

    # æ›´æ–°Prompt
    new_prompt = update_prompt_with_examples(examples)

    return new_prompt
```

---

## ğŸ“ ç›¸å…³æ–‡ä»¶

### æ ¸å¿ƒæ–‡ä»¶
- `evaluate_checkpoints_with_claude.py` - åŸç‰ˆè„šæœ¬
- `evaluate_checkpoints_with_claude_v2.py` - **ä¼˜åŒ–ç‰ˆï¼ˆæ¨èï¼‰**
- `compare_results.py` - ç»“æœå¯¹æ¯”å·¥å…·

### æ–‡æ¡£
- `æå‡æ¨¡å‹æå–å‡†ç¡®æ€§æŒ‡å—.md` - è¯¦ç»†æŠ€æœ¯æŒ‡å—
- `å¿«é€Ÿæ”¹è¿›å‚è€ƒ.md` - å¿«é€Ÿå‚è€ƒå¡ç‰‡
- `ä¼˜åŒ–æ€»ç»“æŠ¥å‘Š.md` - æœ¬æ–‡æ¡£

### é…ç½®
- `test_data/evaluation/evaluation_config.yaml` - APIé…ç½®
- `requirements.txt` - ä¾èµ–ç®¡ç†

---

## ğŸ¯ ç«‹å³è¡ŒåŠ¨

### æœ€å¿«è§æ•ˆæ–¹æ¡ˆï¼ˆ5åˆ†é’Ÿï¼‰

```bash
# 1. è¿è¡Œä¼˜åŒ–ç‰ˆæœ¬
python evaluate_checkpoints_with_claude_v2.py

# 2. æŸ¥çœ‹æ•ˆæœ
python compare_results.py

# 3. å¦‚æœæ•ˆæœä¸æ»¡æ„ï¼Œè°ƒæ•´é˜ˆå€¼
# ç¼–è¾‘ evaluate_checkpoints_with_claude_v2.py
# å°† threshold = 0.3 æ”¹ä¸º 0.25

# 4. é‡æ–°è¿è¡Œ
python evaluate_checkpoints_with_claude_v2.py
```

### æ¨èæ–¹æ¡ˆï¼ˆ30åˆ†é’Ÿï¼‰

```bash
# 1. è¿è¡Œä¼˜åŒ–ç‰ˆæœ¬
python evaluate_checkpoints_with_claude_v2.py

# 2. æŸ¥çœ‹ç»“æœ
python compare_results.py

# 3. å¦‚æœè¦†ç›–ç‡ < 70%ï¼Œæ·»åŠ Few-Shotç¤ºä¾‹
# ç¼–è¾‘ evaluate_checkpoints_with_claude_v2.py
# æŒ‰ç…§"é€‰é¡¹A"çš„ä»£ç æ·»åŠ ç¤ºä¾‹

# 4. å°è¯•æ›´å¼ºæ¨¡å‹
# ç¼–è¾‘ evaluation_config.yaml
# è®¾ç½® zhipuai_model: "glm-4-plus"

# 5. é‡æ–°è¿è¡Œå¹¶å¯¹æ¯”
python evaluate_checkpoints_with_claude_v2.py
python compare_results.py
```

---

## ğŸ’¡ å…³é”®è¦ç‚¹

1. **Promptæ˜¯å…³é”®**ï¼šå¥½çš„Promptå¯ä»¥æå‡50%+æ•ˆæœ
2. **ä¿æŒåŸæ–‡è¡¨è¿°**ï¼šä¸è¦è®©æ¨¡å‹è¿‡åº¦æ¦‚æ‹¬
3. **æä¾›ç¤ºä¾‹**ï¼šFew-Shotå­¦ä¹ éå¸¸æœ‰æ•ˆ
4. **é€‰æ‹©åˆé€‚æ¨¡å‹**ï¼šæ›´å¼ºçš„æ¨¡å‹å¸¦æ¥æ›´å¥½çš„ç†è§£
5. **æŒç»­è¿­ä»£**ï¼šå»ºç«‹åé¦ˆå¾ªç¯ï¼Œä¸æ–­ä¼˜åŒ–

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœé‡åˆ°é—®é¢˜ï¼š
1. æŸ¥çœ‹è¯¦ç»†æŒ‡å—ï¼š`æå‡æ¨¡å‹æå–å‡†ç¡®æ€§æŒ‡å—.md`
2. è¿è¡Œå¯¹æ¯”å·¥å…·ï¼š`python compare_results.py`
3. æ£€æŸ¥APIçŠ¶æ€ï¼š`python quick_test_api.py`
4. æŸ¥çœ‹å®Œæ•´æ–‡æ¡£ï¼š`å¿«é€Ÿæ”¹è¿›å‚è€ƒ.md`

---

**å¼€å§‹ä¼˜åŒ–**ï¼šè¿è¡Œ `python evaluate_checkpoints_with_claude_v2.py` ğŸš€
